<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xmu.discount.mapper.PresaleRuleMapper">
    <resultMap id="presaleRule" type="presaleRule">
        <id column="id" property="id"/>
        <result column="goods_id" property="goodsId"/>
        <result column="start_time" property="startTime"/>
        <result column="ad_end_time" property="adEndTime"/>
        <result column="final_start_time" property="finalStartTime"/>
        <result column="end_time" property="endTime"/>
        <result column="status" property="statusCode"/>
        <result column="deposit" property="deposit"/>
        <result column="gmt_create" property="gmtCreate"/>
        <result column="gmt_modified" property="gmtModified"/>
        <result column="is_deleted" property="beDeleted"/>
        <result column="final_payment" property="finalPayment"/>
    </resultMap>

    <insert id="addPresaleRule" parameterType="presaleRule" useGeneratedKeys="true" keyProperty="id">
        insert into oomall_coupon_rule(goods_id,start_time,ad_end_time,final_start_time,end_time,status,deposit,gmt_create,gmt_modified,is_deleted,final_payment)
        values (#{goodsId},#{startTime},#{adEndTime},#{finalStartTime},#{endTime},#{statusCode},#{deposit},#{gmtCreate},#{gmtModified},#{beDeleted},#{finalPayment})
    </insert>

    <select id="findPresaleRulesByGoodsId" parameterType="Integer" resultMap="presaleRule">
        select id,goods_id,start_time,ad_end_time,final_start_time,end_time,status,deposit,gmt_create,gmt_modified,final_payment,is_deleted from oomall_coupon_rule where goods_id=#{goodsId} and is_deleted=0
    </select>
</mapper>